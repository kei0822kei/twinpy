

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>structure &mdash; twinpy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/contentui.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="twinpy package" href="../apidoc/twinpy.html" />
    <link rel="prev" title="properties" href="properties.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> twinpy
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Definitions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bonding.html">bonding</a></li>
<li class="toctree-l2"><a class="reference internal" href="lattice.html">lattice</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonon.html">phonon</a></li>
<li class="toctree-l2"><a class="reference internal" href="properties.html">properties</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hexagonal-structure">Hexagonal Structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#set-parent">set parent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shear-structure">shear structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#twinboundary-structure">twinboundary structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#old">OLD</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#future-edited">FUTURE EDITED</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#deformation-gradient-tensor">deformation gradient tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-sheared-structure">get_sheared_structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-twin-structure">get_twin_structure</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#hexagonaltwinboundary">HexagonalTwinBoundary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#init">__init__</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">get_sheared_structure</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../apidoc/twinpy.html">API documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">twinpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Definitions</a> &raquo;</li>
        
      <li>structure</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/definitions/structure.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="structure">
<h1>structure<a class="headerlink" href="#structure" title="Permalink to this headline">¶</a></h1>
<p>In this page, some formulations are provided used in structure.py file.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#hexagonal-structure" id="id2">Hexagonal Structure</a></p>
<ul>
<li><p><a class="reference internal" href="#set-parent" id="id3">set parent</a></p></li>
<li><p><a class="reference internal" href="#shear-structure" id="id4">shear structure</a></p></li>
<li><p><a class="reference internal" href="#twinboundary-structure" id="id5">twinboundary structure</a></p></li>
<li><p><a class="reference internal" href="#old" id="id6">OLD</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#future-edited" id="id7">FUTURE EDITED</a></p>
<ul>
<li><p><a class="reference internal" href="#deformation-gradient-tensor" id="id8">deformation gradient tensor</a></p></li>
<li><p><a class="reference internal" href="#get-sheared-structure" id="id9">get_sheared_structure</a></p></li>
<li><p><a class="reference internal" href="#get-twin-structure" id="id10">get_twin_structure</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#hexagonaltwinboundary" id="id11">HexagonalTwinBoundary</a></p>
<ul>
<li><p><a class="reference internal" href="#init" id="id12">__init__</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id13">get_sheared_structure</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="hexagonal-structure">
<h2><a class="toc-backref" href="#id2">Hexagonal Structure</a><a class="headerlink" href="#hexagonal-structure" title="Permalink to this headline">¶</a></h2>
<div class="section" id="set-parent">
<h3><a class="toc-backref" href="#id3">set parent</a><a class="headerlink" href="#set-parent" title="Permalink to this headline">¶</a></h3>
<p>Parent lattice can be defined by specific twin mode.
By this, the following properties are determined.</p>
<ol class="arabic simple">
<li><p>twin indices</p></li>
<li><p>shear strain functoin <img class="math" src="../_images/math/092a4a610010719100b51c6229594c843615ed68.png" alt="\gamma(r)"/></p></li>
<li><p>parent matrix <img class="math" src="../_images/math/9dfd04a129f88c0fa1f54f1be0f8b341ac816661.png" alt="\boldsymbol{M}"/></p></li>
</ol>
<p>where parent matrix <img class="math" src="../_images/math/9dfd04a129f88c0fa1f54f1be0f8b341ac816661.png" alt="\boldsymbol{M}"/> is constructed as bellow</p>
<div class="math">
<p><img src="../_images/math/185571b57022791dfa7a3f29c1c441745c8d55a9.png" alt="[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
=
[\boldsymbol{a}_1,
 \boldsymbol{a}_2,
 \boldsymbol{c}]
\boldsymbol{M}."/></p>
</div><p>where <img class="math" src="../_images/math/ff6e84c5eb12da5be7659539668b87ee90f5a573.png" alt="\boldsymbol{m}^{p}"/>,
<img class="math" src="../_images/math/289fce526b3d66d5185ad4b96711c5211bcaab80.png" alt="\boldsymbol{\eta}^{p}_1"/> and
<img class="math" src="../_images/math/02203fdaf3498d4a319f5f11235ab0f3d90fa118.png" alt="\boldsymbol{\eta}^{p}_2"/> are
a little bit different from the ones in ‘get_twin_indices’ in twinmode.py
because they are rescaled to be the vectors whose element are
all minimum integers.
Therefore, every element of supercell matrix
<img class="math" src="../_images/math/9dfd04a129f88c0fa1f54f1be0f8b341ac816661.png" alt="\boldsymbol{M}"/> is integer. The fractional points <img class="math" src="../_images/math/5cbf91ac89c6a94f352a437d87b12e30be9ccd1f.png" alt="\boldsymbol{X}"/>
is transformed to <img class="math" src="../_images/math/868b700dfc400b1b0fd1351c2e3eb8432f8c4597.png" alt="\boldsymbol{X}^{p}"/> as</p>
<div class="math">
<p><img src="../_images/math/f7fcbd1827d1b7875024d155cbd98a9aaf1dd28e.png" alt="\boldsymbol{X}^{p} = \boldsymbol{M}^{-1} \boldsymbol{X}."/></p>
</div></div>
<div class="section" id="shear-structure">
<h3><a class="toc-backref" href="#id4">shear structure</a><a class="headerlink" href="#shear-structure" title="Permalink to this headline">¶</a></h3>
<p>Shear structure here means the structure which is sheared from parent to
twin structure. Let the bases of shear and twin structure is defined as
<img class="math" src="../_images/math/16def9c278b720bbbeaa257457e40de6920d0902.png" alt="[\boldsymbol{m}^{s}, \boldsymbol{\eta}^{s}_{1},
\boldsymbol{\eta}^{s}_{2}]"/>.
Then</p>
<div class="math">
<p><img src="../_images/math/8971c7a3b71b312131f681fc9b31ec3838ae97b4.png" alt="[\boldsymbol{m}^{s},
 \boldsymbol{\eta}^{s}_{1},
 \boldsymbol{\eta}^{s}_{2}]
=
[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_{1},
 \boldsymbol{\eta}^{p}_{2}]
\boldsymbol{S}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/0813ee7a44fc68c162cfcd6034599461a2e378ef.png" alt="\boldsymbol{S}
=
\begin{pmatrix}
 1 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; \alpha s \\
 0 &amp; 0 &amp; 1 \\
\end{pmatrix}"/></p>
</div><p>where <img class="math" src="../_images/math/2f5aa019312e1bbc969deab8dca8b00f76025404.png" alt="\alpha"/> is shear ratio.
Let fractional points in this shear lattice be <img class="math" src="../_images/math/2ace684f804c4b87a039c2c249d6c543a7a73893.png" alt="\boldsymbol{X^{s}}"/>,</p>
<div class="math">
<p><img src="../_images/math/378e360238f611addc79c8f19387729e3caf5afa.png" alt="\boldsymbol{X^{s}} = \boldsymbol{X^{p}}"/></p>
</div><p>The shear value <img class="math" src="../_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/> is determined as below.
From the figure, shear vector from parent to twin
<img class="math" src="../_images/math/abb75b0a848dcf4f32c26ef89c2b578dfe813948.png" alt="s \boldsymbol{\eta}^{p}_{1}"/> is</p>
<div class="math">
<p><img src="../_images/math/76a019a4ed3b8040db3d14b422ec1be975d2889b.png" alt="s \boldsymbol{\eta}^{p}_{1}
=
\frac{|\gamma| d}{|\boldsymbol{\eta}^{p}_{1}|}
\boldsymbol{\eta}^{p}_{1}"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/36f8d17950f9642e8a340eab57ac09f237c9e405.png" alt="s = \frac{|\gamma| d}{|\boldsymbol{\eta}^{p}_{1}|}"/></p>
</div><p>where <img class="math" src="../_images/math/badad346f6fbe2e237af99bfbd9a93a4da53a3da.png" alt="d"/> is the distance of the point <img class="math" src="../_images/math/dcc216688a65e59e73ffa4e84d3999d3c7d0c421.png" alt="\boldsymbol{\eta}^{p}_{2}"/>
from <img class="math" src="../_images/math/2932bfc4ddb977fbf6a6d823551a8bffd3d35dcc.png" alt="\boldsymbol{K}_2"/> plane.
The bases of twin structure <img class="math" src="../_images/math/e23163f794d275e7793ac5ec5ee4b884180e07ac.png" alt="[\boldsymbol{m}^{t},
\boldsymbol{\eta}^{t}_{1}, \boldsymbol{\eta}^{t}_{2}]"/>
corresponds to <img class="math" src="../_images/math/46cd38352da007b0cec87eff4010bff9d2b34d84.png" alt="\alpha=1"/>.</p>
<p>The fractional positions are unfixed during this transformation
from parent structure to shear and twin structure.</p>
<p>Let the bases of the primitive structure of the shear
as
<img class="math" src="../_images/math/ca7ab263da8af980d25045bee5fe53bfd46e5a4c.png" alt="[\boldsymbol{a}^{s}_{1}, \boldsymbol{a}^{s}_{2}, \boldsymbol{c}^{s}]"/>
can be written as</p>
<div class="math">
<p><img src="../_images/math/ee1a9a778f6d607eb86416c03b5de46a48e0d7a3.png" alt="[\boldsymbol{a}^{s}_{1}, \boldsymbol{a}^{s}_{2}, \boldsymbol{c}^{s}]
=
[\boldsymbol{a}_1,
 \boldsymbol{a}_2,
 \boldsymbol{c}] \boldsymbol{M} \boldsymbol{S} \boldsymbol{M}^{-1}."/></p>
</div><p>Let fractional points in this primitive shear lattice be
<img class="math" src="../_images/math/39a16062960be4295c48d2ddeb09944f2d992105.png" alt="\boldsymbol{X^{sp}}"/>,</p>
<div class="math">
<p><img src="../_images/math/d30983f2979bd656607d63598ea0ef9b8156c07f.png" alt="\boldsymbol{X^{sp}} = \boldsymbol{M} \boldsymbol{X^{s}}"/></p>
</div></div>
<div class="section" id="twinboundary-structure">
<h3><a class="toc-backref" href="#id5">twinboundary structure</a><a class="headerlink" href="#twinboundary-structure" title="Permalink to this headline">¶</a></h3>
<p>For constructing twinboudnary structure,
crystal body rotation is taken place.
In this step, the cartesian basis vectors from
<img class="math" src="../_images/math/2f71ce44846da051cfba0e6cce03b227a07ca069.png" alt="[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]"/> to
<img class="math" src="../_images/math/df4577d452c135d44d6792078338fbd097f6bca4.png" alt="[\boldsymbol{e}_{\boldsymbol{m}^{p}},
\boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
\boldsymbol{e}_{\boldsymbol{k}^{p}_1}]"/>
where
<img class="math" src="../_images/math/209196c6fc1de197e953131411f445614ed9deec.png" alt="\boldsymbol{e}_{\boldsymbol{m}^{p}}
= \frac{\boldsymbol{m}^{p}}{|\boldsymbol{m}^{p}|}"/>
<img class="math" src="../_images/math/e4fc76c633118d1b440d086857a47e04c6fdabc7.png" alt="\boldsymbol{e}_{\boldsymbol{\eta}^{p}_1}
= \frac{\boldsymbol{\eta}^{p}_1}{|\boldsymbol{\eta}^{p}_1|}"/>
<img class="math" src="../_images/math/7e113a35c9b4d2746c0514b4a3bb5e4ea60b4eb9.png" alt="\boldsymbol{e}_{\boldsymbol{k}^{p}_1}
= \frac{\boldsymbol{k}_1}{|\boldsymbol{k}_1|}"/>.
In this step, rotation matrix <img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/> is defined as</p>
<div class="math">
<p><img src="../_images/math/a0f7ce20a4022c83e1d642dda3d4a6133739b307.png" alt="[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
=
[\boldsymbol{Re}_x, \boldsymbol{Re}_y, \boldsymbol{Re}_z]"/></p>
</div><p><img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/> is orthogonal matrix.</p>
<p>Therefore, lattice points and atom positions are rotated as</p>
<div class="math">
<p><img src="../_images/math/6175720ab5439cf4b28d503a6e068f0d91cd8655.png" alt="[\boldsymbol{e}_{x}, \boldsymbol{e}_{y}, \boldsymbol{e}_z]
\boldsymbol{X}_{0}
\rightarrow
[\boldsymbol{e}_{x}, \boldsymbol{e}_{y}, \boldsymbol{e}_z]
\boldsymbol{RX}_{0}"/></p>
</div><p><img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/> is orthogonal matrix</p>
<div class="math">
<p><img src="../_images/math/d82bb838f8e4828d0e972dd572570813a6977c76.png" alt="\boldsymbol{R}^{-1} = \boldsymbol{R}^{T}."/></p>
</div><p>Parent lattice <img class="math" src="../_images/math/b97c1c7098dc6215446db8e3a771932bad98f9ca.png" alt="\bar{\boldsymbol{L}^{p}}"/> and
twin lattice <img class="math" src="../_images/math/fec4557018a076d94fdccc94b21b9ec11a0919f4.png" alt="\bar{\boldsymbol{L}^{t}}"/>
can be calculated in this rotated crystal body as</p>
<div class="math">
<p><img src="../_images/math/a443fb21eb9cfcb930c1512ebea03f08d950c917.png" alt="\bar{\boldsymbol{L}^{p}} = \boldsymbol{RHM}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/3503d52bcc1c12d7bf5c93be1d03226a4f8c15c0.png" alt="\bar{\boldsymbol{L}^{t}} = \boldsymbol{WRHM}"/></p>
</div><p>parent atom cartesian atom positions <img class="math" src="../_images/math/e0830d34a500f876e3b42c7fc8d70d246e0d4220.png" alt="\bar{\boldsymbol{X}^{p}_{0}}"/> and
twin atom cartesian atom positions <img class="math" src="../_images/math/6840bb441f265ce2c4e6ceb5832f0cc48d8e396a.png" alt="\bar{\boldsymbol{X}^{t}_{0}}"/>
in the rotated crystal body is</p>
<div class="math">
<p><img src="../_images/math/ffd2115e499006a2f29b44dce4aac053e37616f9.png" alt="\bar{\boldsymbol{X}^{p}_{0}} = \boldsymbol{RX}^{p}_{0}"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/814f49c0e3b368e26297b6b3cc59dc23189e0fbd.png" alt="\bar{\boldsymbol{X}^{t}_{0}} = \boldsymbol{WRX}^{p}_{0}"/></p>
</div></div>
<div class="section" id="old">
<h3><a class="toc-backref" href="#id6">OLD</a><a class="headerlink" href="#old" title="Permalink to this headline">¶</a></h3>
<p>First, supercell matrix <img class="math" src="../_images/math/9dfd04a129f88c0fa1f54f1be0f8b341ac816661.png" alt="\boldsymbol{M}"/> is constructed as bellow</p>
<div class="math">
<p><img src="../_images/math/185571b57022791dfa7a3f29c1c441745c8d55a9.png" alt="[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
=
[\boldsymbol{a}_1,
 \boldsymbol{a}_2,
 \boldsymbol{c}]
\boldsymbol{M}."/></p>
</div><p>where <img class="math" src="../_images/math/ff6e84c5eb12da5be7659539668b87ee90f5a573.png" alt="\boldsymbol{m}^{p}"/>,
<img class="math" src="../_images/math/289fce526b3d66d5185ad4b96711c5211bcaab80.png" alt="\boldsymbol{\eta}^{p}_1"/> and
<img class="math" src="../_images/math/02203fdaf3498d4a319f5f11235ab0f3d90fa118.png" alt="\boldsymbol{\eta}^{p}_2"/> are
a little bit different from the ones in ‘get_twin_indices’ in twinmode.py
because they are rescaled to be the vectors whose element are all integer.
Therefore, every element of supercell matrix
<img class="math" src="../_images/math/9dfd04a129f88c0fa1f54f1be0f8b341ac816661.png" alt="\boldsymbol{M}"/> is integer.
In this step, the positions of the lattice points
in the original hexagonal lattice <img class="math" src="../_images/math/068f9a5bbabb07551cd947b13659d5f9de44e1a4.png" alt="\boldsymbol{X}^{p}_{lat}"/> and
the relative positions of the atoms from each lattice point
<img class="math" src="../_images/math/3d98da2ad23bf58392c542130a9f294cd3f19309.png" alt="\boldsymbol{X}^{p}_{atm}"/> are defined in
<img class="math" src="../_images/math/fa9f39c7c3b16f0fb85e645f30d75f7f3e819c40.png" alt="[\boldsymbol{m}^{p}, \boldsymbol{\eta}^{p}_1, \boldsymbol{\eta}^{p}_2]"/> basis
where</p>
<div class="math">
<p><img src="../_images/math/60c81a107ca9a75e59a18c1eaa7cee9d1180c1a4.png" alt="[\boldsymbol{a}_1,
 \boldsymbol{a}_2,
 \boldsymbol{c}]
\boldsymbol{X}_{atm}
=
[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
\boldsymbol{X}^{p}_{atm}
=
[\boldsymbol{a}_1,
 \boldsymbol{a}_2,
 \boldsymbol{c}]
\boldsymbol{M} \boldsymbol{X}^{p}_{atm}"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/f40dcebe31f48d852ef455ad1a5cf728c7efb581.png" alt="\boldsymbol{X}^{p}_{atm} = \boldsymbol{M}^{-1} \boldsymbol{X}_{atm}"/></p>
</div><p>In the next step, the cartesian basis vectors from
<img class="math" src="../_images/math/2f71ce44846da051cfba0e6cce03b227a07ca069.png" alt="[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]"/> to
<img class="math" src="../_images/math/df4577d452c135d44d6792078338fbd097f6bca4.png" alt="[\boldsymbol{e}_{\boldsymbol{m}^{p}},
\boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
\boldsymbol{e}_{\boldsymbol{k}^{p}_1}]"/>
where
<img class="math" src="../_images/math/209196c6fc1de197e953131411f445614ed9deec.png" alt="\boldsymbol{e}_{\boldsymbol{m}^{p}}
= \frac{\boldsymbol{m}^{p}}{|\boldsymbol{m}^{p}|}"/>
<img class="math" src="../_images/math/e4fc76c633118d1b440d086857a47e04c6fdabc7.png" alt="\boldsymbol{e}_{\boldsymbol{\eta}^{p}_1}
= \frac{\boldsymbol{\eta}^{p}_1}{|\boldsymbol{\eta}^{p}_1|}"/>
<img class="math" src="../_images/math/7e113a35c9b4d2746c0514b4a3bb5e4ea60b4eb9.png" alt="\boldsymbol{e}_{\boldsymbol{k}^{p}_1}
= \frac{\boldsymbol{k}_1}{|\boldsymbol{k}_1|}"/>.
In this step, rotation matrix <img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/> is defined</p>
<div class="math">
<p><img src="../_images/math/730fb2b1e252838e96ad908026bbd7d9432cff1b.png" alt="[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
=
[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]
\boldsymbol{R}"/></p>
</div><p><img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/> is orthogonal matrix.</p>
<div class="math">
<p><img src="../_images/math/bb8b8e871fbd302541881437107e1a19c2fa42a1.png" alt="\boldsymbol{R}^{-1} = \boldsymbol{R}^{T}"/></p>
</div><p>When the number vectors <img class="math" src="../_images/math/536639dbefa3abdc15ebc47c07553b0ac83f2c92.png" alt="\boldsymbol{X}_{0}"/> are transformed to
<img class="math" src="../_images/math/52a5ea2b3c9810e2dfd4bd390c0ea4aa42d9ad8a.png" alt="\boldsymbol{X}^{p}_{0}"/> by this operation, the following relations hold.</p>
<div class="math">
<p><img src="../_images/math/783cd9277bfaeb7273fb4bf09b14abfc09d9d223.png" alt="[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]
\boldsymbol{X}_{0}
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{X}^{p}_{0}
=
[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]
\boldsymbol{R} \boldsymbol{X}^{p}_{0}"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/51a2957cd1709f4b79fef81330a765ab34a2a861.png" alt="\boldsymbol{X}^{p}_{0}
=
\boldsymbol{R}^{-1} \boldsymbol{X}_{0}
=
\boldsymbol{R}^{T} \boldsymbol{X}_{0}"/></p>
</div><p>Be careful if you use <cite>def pymatgen.core.structure.Structure.apply_operation</cite>,
<strong>its input rotation matrix is</strong> <img class="math" src="../_images/math/7a874fd6d87c09623acfaae6ff2796307950af06.png" alt="\boldsymbol{R}^{T}"/>,
<strong>NOT</strong> <img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/>.</p>
<p>In the last step, parent lattice <img class="math" src="../_images/math/596c534cf05da4c5d20210e1488dacaa5d2f04c4.png" alt="\boldsymbol{L}_p"/> is defined as</p>
<div class="math">
<p><img src="../_images/math/10376634bd8682bdfdb300b36472dff43ac55ca4.png" alt="[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
=
[\boldsymbol{a}_1, \boldsymbol{a}_2, \boldsymbol{c}]
\boldsymbol{M}
=
[\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z]
\boldsymbol{H} \boldsymbol{M}
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{R}^{-1} \boldsymbol{H} \boldsymbol{M}
\equiv
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}_p"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/5aafd65a533bffd51dec68801a56aae6e3ff7cf8.png" alt="\boldsymbol{L}^p = \boldsymbol{R}^{-1} \boldsymbol{H} \boldsymbol{M}."/></p>
</div><p>The coordinates of each points in
<img class="math" src="../_images/math/fa9f39c7c3b16f0fb85e645f30d75f7f3e819c40.png" alt="[\boldsymbol{m}^{p}, \boldsymbol{\eta}^{p}_1, \boldsymbol{\eta}^{p}_2]"/>
basis such as <img class="math" src="../_images/math/068f9a5bbabb07551cd947b13659d5f9de44e1a4.png" alt="\boldsymbol{X}^{p}_{lat}"/> and
<img class="math" src="../_images/math/3d98da2ad23bf58392c542130a9f294cd3f19309.png" alt="\boldsymbol{X}^{p}_{atm}"/>
<strong>DOES NOT</strong> be affected by this transformation.</p>
<p><strong>HOWEVER</strong>, <img class="math" src="../_images/math/3d98da2ad23bf58392c542130a9f294cd3f19309.png" alt="\boldsymbol{X}^{p}_{atm}"/> may have to revise
because two rigid atoms must be the nearest atoms from the specified
<img class="math" src="../_images/math/521add3adc34b5fc2d29366b56b3ddc355233676.png" alt="\boldsymbol{K}_1"/> plane. In the case you choose ‘c’ wyckoff letter,
this revising (probably) always occur.</p>
</div>
</div>
<div class="section" id="future-edited">
<h2><a class="toc-backref" href="#id7">FUTURE EDITED</a><a class="headerlink" href="#future-edited" title="Permalink to this headline">¶</a></h2>
<div class="section" id="deformation-gradient-tensor">
<h3><a class="toc-backref" href="#id8">deformation gradient tensor</a><a class="headerlink" href="#deformation-gradient-tensor" title="Permalink to this headline">¶</a></h3>
<p>In the provious section, shear structure is introduced. Now, we can
hold deformation gradient tensor from this shear. In general, deformation
gradient tensor can be defined as</p>
<div class="math">
<p><img src="../_images/math/823fd2b1e6d6a90dac8a32fb78f9efb5b46487a4.png" alt="\boldsymbol{F}
=
\frac{\partial \boldsymbol{x}}{\partial \boldsymbol{X}}
=
\frac{\partial (\boldsymbol{X} + \boldsymbol{u})}{\partial \boldsymbol{X}}
=
\boldsymbol{I} + \frac{\partial \boldsymbol{u}}{\partial \boldsymbol{X}}."/></p>
</div><p>Shear strain corresponds to <img class="math" src="../_images/math/acbd6403b10c2a4b488952f1f8c94040f384e20d.png" alt="\frac{\partial \boldsymbol{u}}{\boldsymbol{X}}"/>
However, note this equation is on the basis of cartesian coordinate.
So we have to consider the matrix <img class="math" src="../_images/math/b988975be41fd13b4d091c10202ba19374643586.png" alt="S"/> on the same coordinate as</p>
<div class="math">
<p><img src="../_images/math/71d297a16fd5677780dcae27f2d117c5a844e014.png" alt="[\boldsymbol{e}_{x}, \boldsymbol{e}_{y}, \boldsymbol{e}_{z}]
\boldsymbol{X}_{0}
=
[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_{1},
 \boldsymbol{\eta}^{p}_{2}]
\boldsymbol{M}^{-1} \boldsymbol{H}^{-1} \boldsymbol{X}_{0}"/></p>
</div><div class="math">
<p><img src="../_images/math/812090ee3f4e6edd2889b61b480fba5444c7d812.png" alt="\rightarrow
[\boldsymbol{m}^{s},
 \boldsymbol{\eta}^{s}_{1},
 \boldsymbol{\eta}^{s}_{2}]
\boldsymbol{M}^{-1} \boldsymbol{H}^{-1} \boldsymbol{X}_{0}
=
[\boldsymbol{e}_{x}, \boldsymbol{e}_{y}, \boldsymbol{e}_{z}]
\boldsymbol{H} \boldsymbol{M} \boldsymbol{S}
\boldsymbol{M}^{-1} \boldsymbol{H}^{-1} \boldsymbol{X}_{0}."/></p>
</div><p>So deformation gradient tensor can be defined as</p>
<div class="math">
<p><img src="../_images/math/e2f245344371e5d406d0f37d48b1c7794c437de8.png" alt="\boldsymbol{F}
=
\boldsymbol{I} +
\boldsymbol{H} \boldsymbol{M} \boldsymbol{S}
\boldsymbol{M}^{-1} \boldsymbol{H}^{-1}"/></p>
</div><p>and let material stretch tensor as <img class="math" src="../_images/math/973a728f00b1e10d19ac00f38f5fb4815dd285d6.png" alt="\boldsymbol{U}"/>
, spatial stretch tensor as <img class="math" src="../_images/math/0c1f55bbaf294cecec761d82cc1628008361b224.png" alt="\boldsymbol{V}"/>
, rotaion as <img class="math" src="../_images/math/69e6c3d0cc9468d6621bc001f4d6cd79b3443cbd.png" alt="\boldsymbol{R}"/>
, right Cauchy-Green tensor as <img class="math" src="../_images/math/b58fe1b48e0cf7e5258a9c9372fca7c8b2a4831d.png" alt="\boldsymbol{C}"/>
, left Cauchy-Green tensor as <img class="math" src="../_images/math/dc20617d840054eb270345956048aa3135680419.png" alt="\boldsymbol{b}"/>
then</p>
<div class="math">
<p><img src="../_images/math/533c55c06e1140b64a24926bfd54b6f87bdc513b.png" alt="\boldsymbol{C} = \boldsymbol{U}^2 = \boldsymbol{F}^{T} \boldsymbol{F}

\boldsymbol{b} = \boldsymbol{V}^2 = \boldsymbol{F} \boldsymbol{F}^{T}

\boldsymbol{R} = \boldsymbol{F} \boldsymbol{U}^{-1}
               = \boldsymbol{V}^{-1} \boldsymbol{F}"/></p>
</div></div>
<div class="section" id="get-sheared-structure">
<h3><a class="toc-backref" href="#id9">get_sheared_structure</a><a class="headerlink" href="#get-sheared-structure" title="Permalink to this headline">¶</a></h3>
<p>When the shear ratio is <img class="math" src="../_images/math/7577271740b61a8652e005b95ad778b8421b13e2.png" alt="\boldsymbol{r}"/>,
the basis vectors of sheared structure are given as</p>
<div class="math">
<p><img src="../_images/math/c128fcc2a2df2aba349ea4e8a77c9a60347edaf8.png" alt="[\boldsymbol{m}^{s},
 \boldsymbol{\eta}^{s}_1,
 \boldsymbol{\eta}^{s}_2]
=
[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2 + \boldsymbol{d}]"/></p>
</div><p>where <img class="math" src="../_images/math/20652bb8fee65d3fbcf2f602648b3b5a948bb488.png" alt="\boldsymbol{d}"/> is given as</p>
<div class="math">
<p><img src="../_images/math/2dda32affa6324f701d0ad93af825c3509114fa3.png" alt="\boldsymbol{d}
=
r |\gamma(\boldsymbol{r})|
(\boldsymbol{\eta}^{p}_2 \cdot \boldsymbol{e}_{\boldsymbol{k}^{p}_1})
\boldsymbol{e}_{\boldsymbol{\eta}^{p}_1}
=
r s \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/1f5565f76e997f798de8ab70ac9495e226115f87.png" alt="s
=
|\gamma(\boldsymbol{r})|
(\boldsymbol{\eta}^{p}_2 \cdot \boldsymbol{e}_{\boldsymbol{k}^{p}_1})."/></p>
</div><p>Therefore, sheared lattice <img class="math" src="../_images/math/7e0404b1aa91eb626ebcc37b0fbacf6c46daefcd.png" alt="\boldsymbol{L}_s"/> is given as</p>
<div class="math">
<p><img src="../_images/math/1da4283247562302f9e0274db4a919cd5da2d88d.png" alt="[\boldsymbol{m}^{s},
 \boldsymbol{\eta}^{s}_1,
 \boldsymbol{\eta}^{s}_2]
=
[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2 + r s \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1}]
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}^s"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/1fb2b67b27715542d8bd67d3abf58a44c33193ff.png" alt="\boldsymbol{L}^s = \boldsymbol{L}^p + r \boldsymbol{S}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/fdc5e621e82fac4741bc348f1ac23ed1aa12da7b.png" alt="\boldsymbol{S}
=
\begin{pmatrix}
 0 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; s \\
 0 &amp; 0 &amp; 0 \\
\end{pmatrix}."/></p>
</div></div>
<div class="section" id="get-twin-structure">
<h3><a class="toc-backref" href="#id10">get_twin_structure</a><a class="headerlink" href="#get-twin-structure" title="Permalink to this headline">¶</a></h3>
<p>The operation from parent lattice to twin lattice
<img class="math" src="../_images/math/774bbce0f5b0238a701a63d2c7a040441d2ba15d.png" alt="\boldsymbol{W}^{t}"/> is defined as</p>
<div class="math">
<p><img src="../_images/math/ab492fd70bfc11fca5e2269689ee62c81f64c01c.png" alt="[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{X}^{p}_{0}
\longrightarrow
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{X}^{t}_{0}."/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/428867881a03fb23a4a84957ad28fb997acd13c4.png" alt="\boldsymbol{X}^{t}_{0} = \boldsymbol{W}^{t} \boldsymbol{X}^{p}_{0}."/></p>
</div><p>In twin type <img class="math" src="../_images/math/94c1acc9179d3d89c3e455f99bdde0b36560fb88.png" alt="\rm{I}"/>,
rotation matrix <img class="math" src="../_images/math/774bbce0f5b0238a701a63d2c7a040441d2ba15d.png" alt="\boldsymbol{W}^{t}"/>
is given as</p>
<div class="math">
<p><img src="../_images/math/fcccdd416b4d9fc52567a23e4f757c5357d95d53.png" alt="\boldsymbol{W}^{t}
=
\begin{pmatrix}
 1 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; 0 \\
 0 &amp; 0 &amp; -1 \\
\end{pmatrix}."/></p>
</div><p>In twin type <img class="math" src="../_images/math/c711f37d539cb4334ef98ab8a1c044aa72f7b802.png" alt="\rm{I\hspace{-1pt}I}"/>,
rotation matrix <img class="math" src="../_images/math/fafe3caa3bf0498d8484d8a014eb9ed8d7456efa.png" alt="\boldsymbol{W}^t"/>
is given as</p>
<div class="math">
<p><img src="../_images/math/023d785576bbaff84fdce06755ff921b6de18701.png" alt="\boldsymbol{W}^{t}
=
\begin{pmatrix}
 -1 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; 0 \\
 0 &amp; 0 &amp; -1 \\
\end{pmatrix}."/></p>
</div><p>In both type, the following equation hold.</p>
<div class="math">
<p><img src="../_images/math/04177c404c0dbcb24224fe41da80d4c8d5c7039f.png" alt="\boldsymbol{W}^{t,-1} = \boldsymbol{W}^{t,T} = \boldsymbol{W}"/></p>
</div><p>The relation between parent lattice <img class="math" src="../_images/math/52049f57402e02212cb4f47b79f94cda46420cab.png" alt="\boldsymbol{L}^{p}"/>
and twin lattice <img class="math" src="../_images/math/0a69ae378b1d3d97eca67912da3427c0366fa4c7.png" alt="\boldsymbol{L}^{t}"/> is</p>
<div class="math">
<p><img src="../_images/math/912c2d4000234edd813b97f7abe21de81b577f38.png" alt="[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}^{p}
\longrightarrow
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{W}^{t}
\boldsymbol{L}^{p}
\equiv
[\boldsymbol{m}^{t},
 \boldsymbol{\eta}^{t}_1,
 \boldsymbol{\eta}^{t}_2]"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/96d19c24b2cd6175083d460acc90408e7981f14b.png" alt="[\boldsymbol{m}^{t},
 \boldsymbol{\eta}^{t}_1,
 \boldsymbol{\eta}^{t}_2]
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}^{t}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/c6c1e22bc70bf79b234496460091d5426be725a4.png" alt="\boldsymbol{L}^{t}
=
\boldsymbol{W}^{t}
\boldsymbol{L}^{p}."/></p>
</div><p>By this transformation, number vectors in the basis of
parent vectors <img class="math" src="../_images/math/868b700dfc400b1b0fd1351c2e3eb8432f8c4597.png" alt="\boldsymbol{X}^{p}"/> (including
<img class="math" src="../_images/math/068f9a5bbabb07551cd947b13659d5f9de44e1a4.png" alt="\boldsymbol{X}^{p}_{lat}"/> and <img class="math" src="../_images/math/3d98da2ad23bf58392c542130a9f294cd3f19309.png" alt="\boldsymbol{X}^{p}_{atm}"/>)
are not affected.</p>
<div class="math">
<p><img src="../_images/math/c951e8ef1bbb4984731aa36550a09377cd83155a.png" alt="[\boldsymbol{m}^{p},
 \boldsymbol{\eta}^{p}_1,
 \boldsymbol{\eta}^{p}_2]
\boldsymbol{X}^{p}
&amp;=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}^{p}
\boldsymbol{X}^{p} \\
&amp;\longrightarrow
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{W}^{t}
\boldsymbol{L}^{p}
\boldsymbol{X}^{p} \\
&amp;=
[\boldsymbol{m}^{t},
 \boldsymbol{\eta}^{t}_1,
 \boldsymbol{\eta}^{t}_2]
\boldsymbol{L}^{p,-1}
\boldsymbol{W}^{t,-1}
\boldsymbol{W}^{t}
\boldsymbol{L}^{p}
\boldsymbol{X}^{p} \\
&amp;=
[\boldsymbol{m}^{t},
 \boldsymbol{\eta}^{t}_1,
 \boldsymbol{\eta}^{t}_2]
\boldsymbol{X}^{p}
\equiv
[\boldsymbol{m}^{t},
 \boldsymbol{\eta}^{t}_1,
 \boldsymbol{\eta}^{t}_2]
\boldsymbol{X}^{t}"/></p>
</div><p>so number vectors in the basis of
twin vectors <img class="math" src="../_images/math/bd4303fa8be00df6381102ea18fb0a401d06a78f.png" alt="\boldsymbol{X}^{t}"/> (including
<img class="math" src="../_images/math/39f592f599b18d16ba2bb4f4fb9774b27a4f40fd.png" alt="\boldsymbol{X}^{t}_{lat}"/> and <img class="math" src="../_images/math/23d033842332aed28de0f188b3c5b00877171699.png" alt="\boldsymbol{X}^{t}_{atm}"/>)</p>
<div class="math">
<p><img src="../_images/math/5846be57b82425d387b451beacf71ef6b5fa4a8a.png" alt="\boldsymbol{X}^{t} = \boldsymbol{X}^{p}"/></p>
</div></div>
</div>
<div class="section" id="hexagonaltwinboundary">
<h2><a class="toc-backref" href="#id11">HexagonalTwinBoundary</a><a class="headerlink" href="#hexagonaltwinboundary" title="Permalink to this headline">¶</a></h2>
<div class="section" id="init">
<h3><a class="toc-backref" href="#id12">__init__</a><a class="headerlink" href="#init" title="Permalink to this headline">¶</a></h3>
<p>To create ‘HexagonalTwinBoundary’ object, you have to specify
the norm of a and c axis and its specie as a hexagonal metal
information. Moreover, twinmode, twintype, dimension and
x- y- shift respectively. If you set dimension equal ‘[1,1,2]’
and x-shift equal ‘1/2’, then parent and twin structures with
its supecell as [1,1,2] and fix all the parent lattice point to
-1/4 from its original points and fix all the twin lattice point to
1/4 from its original points. Then, dichromatic lattice
<img class="math" src="../_images/math/bdca0e8e26eb4ff5a5f8ec6ea27cbd051e723de8.png" alt="\boldsymbol{L}^{d}"/> is created.</p>
<div class="math">
<p><img src="../_images/math/67eb0729144db7acc4fd077b1d92c4f0b38cd3aa.png" alt="[\boldsymbol{m}^{d},
 \boldsymbol{\eta}^{d}_1,
 \boldsymbol{k}^{d}_1]
=
[\boldsymbol{e}_{\boldsymbol{m}^{p}},
 \boldsymbol{e}_{\boldsymbol{\eta}^{p}_1},
 \boldsymbol{e}_{\boldsymbol{k}^{p}_1}]
\boldsymbol{L}^{d}"/></p>
</div><p>In the case ‘dim=[1,1,1]’, dichromatic lattice
<img class="math" src="../_images/math/bdca0e8e26eb4ff5a5f8ec6ea27cbd051e723de8.png" alt="\boldsymbol{L}^{d}"/> becomes</p>
<div class="math">
<p><img src="../_images/math/43cce5b7c32cb56dfd3e481b5875f2ddbc758edf.png" alt="\boldsymbol{L}^{d}
=
\boldsymbol{L}^{s}(r=0.5)
\begin{pmatrix}
 1 &amp; 0 &amp; 0 \\
 0 &amp; 1 &amp; 0 \\
 0 &amp; 0 &amp; 2 \\
\end{pmatrix}."/></p>
</div><p>After this, number vectors <img class="math" src="../_images/math/de78476bb6352ce88319b64447b33d0bff81aba6.png" alt="\boldsymbol{X}^{p,t}"/>
in the bases both parent and twin
are transformed into the dichromatic lattice frame.</p>
<div class="math">
<p><img src="../_images/math/d6e9d87bf4590eef9644adf0a35c68eed78fb926.png" alt="\boldsymbol{L}^{p,t} \boldsymbol{X}^{p,t}
=
\boldsymbol{L}^{d} \boldsymbol{X}^{d}"/></p>
</div><p>so</p>
<div class="math">
<p><img src="../_images/math/94ca20bb15a2e07bfd2f8e1a93b6ab80e5a42009.png" alt="\boldsymbol{X}^{d}
=
\boldsymbol{L}^{d -1} \boldsymbol{L}^{p,t} \boldsymbol{X}^{p,t}"/></p>
</div></div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id13">get_sheared_structure</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The twin boundary structure can be sheared by this function.
Input ‘gamma’ represents shear strain (<img class="math" src="../_images/math/a292e637c73a2ac5409b375c3f31ca80fad0b3b0.png" alt="\gamma'"/>).
dichromatic lattice are sheared as</p>
<div class="math">
<p><img src="../_images/math/4c130fb139475bbc3d1b337b6fbd6247f4bcf4aa.png" alt="\boldsymbol{L}^{d, s} = \boldsymbol{L}^{d} + \boldsymbol{S}"/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/d6453e1228237b2e23e974d3e02333e55315654e.png" alt="\boldsymbol{S}
=
\begin{pmatrix}
 0 &amp; 0 &amp; 0 \\
 0 &amp; 0 &amp; s' \\
 0 &amp; 0 &amp; 0 \\
\end{pmatrix}."/></p>
</div><p>where</p>
<div class="math">
<p><img src="../_images/math/afe983f66459467e3fb46ecf8fa90f507e822b2f.png" alt="s'
=
\gamma' |\boldsymbol{k}^{d}_1|"/></p>
</div></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../apidoc/twinpy.html" class="btn btn-neutral float-right" title="twinpy package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="properties.html" class="btn btn-neutral float-left" title="properties" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020-2021, kei0822kei. All rights reserved

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>